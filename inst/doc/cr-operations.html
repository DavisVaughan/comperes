<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Evgeni Chasnovski" />

<meta name="date" content="2017-06-13" />

<title>Operations with competition results</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Operations with competition results</h1>
<h4 class="author"><em>Evgeni Chasnovski</em></h4>
<h4 class="date"><em>2017-06-13</em></h4>



<p><code>comperes</code> package is designed for</p>
<ul>
<li>operation with abstract competition results (CR);</li>
<li>computation of ratings and rankings based CR.</li>
</ul>
<p>This vignette describes supported formats for CR and operations with them.</p>
<div id="formats" class="section level2">
<h2>Formats</h2>
<p>It is assumed that competition consists from multiple games (matches, comparisons, etc.). In general games can consist from variable number of players. Inside a game all players are treated equally. In every game every player has some score: the value of arbitrary nature that fully characterizes player’s performance in particular game (in most cases it is some numeric value).</p>
<div id="long-cr-format" class="section level3">
<h3>Long CR format</h3>
<p>Long format is the most general way to represent CR because it naturally allows one game to consist from <strong>variable</strong> number of players. Results should be in “data.frame-like” format with observational unit (row) being score of particular player in particular game.</p>
<p>In <code>comperes</code> this format is supported with <code>longcr</code> S3 class which inherits from tibble. Data in this format should have at least three columns with the following names:</p>
<ul>
<li><code>game</code> - game identifier;</li>
<li><code>player</code> - player identifier;</li>
<li><code>score</code> - score of particular player in particular game.</li>
</ul>
<p>Extra columns are allowed. <strong>Note</strong> that if <code>longcr</code> object is converted to <code>widecr</code> (wide format which is described next) they will be dropped. So it is better to store extra information about <code>game</code>-<code>player</code> pair as list-column <code>score</code> which will stay untouched.</p>
<p>As example of <code>longcr</code> object one can use <code>ncaa2005</code> which is a built-in dataset in <code>comperes</code> package:</p>
<pre><code>## # A longcr object:
## # A tibble: 20 x 3
##    game player score
##   &lt;int&gt;  &lt;chr&gt; &lt;int&gt;
## 1     1   Duke     7
## 2     1  Miami    52
## 3     2   Duke    21
## 4     2    UNC    24
## 5     3   Duke     7
## 6     3    UVA    38
## # ... with 14 more rows</code></pre>
<p>There is an S3 method for easy conversion to <code>longcr</code>: <code>to_longcr</code>. Its default version converts argument to tibble and adds <code>longcr</code> to result’s class. If argument of <code>to_longcr</code> is a proper <code>longcr</code> object then it stays untouched. In case of <code>widecr</code> the actual conversion to <code>longcr</code> is made preserving all extra columns.</p>
<p><code>to_longcr</code> has argument <code>repair</code>. If <code>TRUE</code> then the result is ensured to have proper structure: there will be columns <code>game</code>, <code>player</code>, <code>score</code> and there will be no duplicated <code>game</code>-<code>player</code> pairs. If they were not detected in original data then they are created as new columns with <code>NA</code>s and appropriate message is given. In case of imperfect matching of column names there also will be a message. For more details see <code>?to_longcr</code>.</p>
</div>
<div id="wide-cr-format" class="section level3">
<h3>Wide CR format</h3>
<p>Wide format is preferred if all games consist from the <strong>constant</strong> number of players. Results should be in “data.frame-like” format with observational unit (row) being one particular game. Data should be organized in pairs of columns <code>player</code>-<code>score</code>. Identifier of a pair should go after respective keyword and consist only from digits. For example: player1, score1, player2, score2. Order doesn’t matter. Extra columns are allowed.</p>
<p>To account for R standard string ordering, identifiers of pairs should be formatted with possible leading zeros. For example: player01, score01, …, player10, score10.</p>
<p>Column <code>game</code> for game identifier is optional. If present it will be used in conversion to <code>longcr</code> format via <code>to_longcr</code>.</p>
<p>Here is the <code>widecr</code> version of <code>ncaa2005</code> dataset:</p>
<pre><code>## # A widecr object:
## # A tibble: 10 x 5
##    game player1 score1 player2 score2
##   &lt;int&gt;   &lt;chr&gt;  &lt;int&gt;   &lt;chr&gt;  &lt;int&gt;
## 1     1    Duke      7   Miami     52
## 2     2    Duke     21     UNC     24
## 3     3    Duke      7     UVA     38
## # ... with 7 more rows</code></pre>
<p>As is with <code>longcr</code> there is an S3 method for easy conversion to <code>widecr</code>: <code>to_widecr</code>. Its default version converts argument to tibble and adds <code>widecr</code> to result’s class. If argument of <code>to_widecr</code> is a proper <code>widecr</code> object then it stays untouched. In case of <code>longcr</code> the actual conversion to <code>widecr</code> is made using only columns <code>game</code>, <code>player</code> and <code>score</code>.</p>
<p><code>to_widecr</code> has argument <code>repair</code>. If <code>TRUE</code> then it detects possible <code>player</code>-<code>score</code> pairs by the identifier of a pair (characters that go after respective keywords). If some column doesn’t have pair it is created as new column with <code>NA</code>s. For more details see <code>?to_widecr</code>.</p>
<p>A useful case of wide CR format is pairgames: CR in which games are held between two players. It is just <code>widecr</code> object with two players. Also it is the most popular case of CR for rating and ranking systems. There is a function <code>to_pairgames</code> to create pairgames from general CR: it drops games with one player and for every game with 3 and more players this function transforms it into set of separate games between unordered pairs of players. It accepts CR in format ready for <code>to_longcr</code>. For more details see <code>?to_pairgames</code>. The usage example is as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cr_data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">game =</span> <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">player =</span> <span class="dv">11</span>:<span class="dv">13</span>, <span class="dt">score =</span> <span class="dv">101</span>:<span class="dv">103</span>)
<span class="kw">to_pairgames</span>(cr_data)</code></pre></div>
<pre><code>## # A widecr object:
## # A tibble: 3 x 5
##    game player1 score1 player2 score2
##   &lt;int&gt;   &lt;int&gt;  &lt;int&gt;   &lt;int&gt;  &lt;int&gt;
## 1     1      11    101      12    102
## 2     2      11    101      13    103
## 3     3      12    102      13    103</code></pre>
</div>
</div>
<div id="operations" class="section level2">
<h2>Operations</h2>
<p>After conversion of CR into appropriate format one can use them for several types of operations.</p>
<div id="compute-head-to-head-matrix" class="section level3">
<h3>Compute Head-to-Head matrix</h3>
<p>Head-to-Head value is a measure of a quality of direct confrontation between two players. It is assumed that this value can be computed based only on the players’ scores in their common games. If it is not true for some case then competition results should be changed by transformation or addition of more information (in form of extra columns or extra field in <code>score</code> column(s) making list-column(s)).</p>
<p>Head-to-Head value is computed for an ordered pair of players based on their matchups. It means that Head-to-Head value for “player1”-“player2” may be different from “player2”-“player1”. It is done in order to except not symmetrical Head-to-Head values.</p>
<p>There is a function for computing multiple Head-to-Head values in matrix form (Head-to-Head matrix): <code>get_h2h</code>. It accepts CR data and Head-to-Head function <code>h2h_fun</code> (for more details see <code>?get_h2h</code>). It returns an object of class <code>h2h</code>: square matrix with number of rows (and columns) equal to number of players for which it is computed. The Head-to-Head matrix of <code>ncaa2005</code> with Head-to-Head value being number of wins of second player in matchups:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">get_h2h</span>(ncaa2005, <span class="dt">h2h_fun =</span> h2h_num_wins)</code></pre></div>
<pre><code>##       Duke Miami UNC UVA VT
## Duke     0     1   1   1  1
## Miami    0     0   0   0  0
## UNC      0     1   0   0  1
## UVA      0     1   1   0  1
## VT       0     1   0   0  0</code></pre>
<p>For the list of implemented <code>h2h_fun</code>s see help page for <code>head-to-head-functions</code>.</p>
<p><code>get_h2h</code> has argument <code>players</code>. By default it is <code>NULL</code> and it means that Head-to-Head values are computed for all players present in CR. If not <code>NULL</code> then Head-to-Head values are computed only for pairs between players from argument <code>players</code>. <strong>Note</strong> to be careful with Head-to-Head values of players with themselves: it can be inaccurate if <code>players</code> is not <code>NULL</code> because it will be based on possibly undesirable data. Example for Head-to-Head value being number of games played:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">get_h2h</span>(ncaa2005, <span class="dt">h2h_fun =</span> h2h_num, <span class="dt">players =</span> <span class="kw">c</span>(<span class="st">&quot;Duke&quot;</span>, <span class="st">&quot;Miami&quot;</span>))</code></pre></div>
<pre><code>##       Duke Miami
## Duke     4     1
## Miami    1     4</code></pre>
<p>The output can be wrongly interpreted as Head-to-Head matrix based on CR from which only games between “Duke” and “Miami” are taken. The correct interpretation is as Head-to-Head matrix based on matchups from the whole <code>ncaa2005</code> between players from given set. So the number of games played by “Duke” in the supplied CR is 4. It can be rephrased as the number of matchups of “Duke” with itself so the output is conceptually correct.</p>
<p>Argument <code>players</code> can also have values that are not present in CR data. The resulting rows and columns will be filled with <code>NA</code>s. For dealing with absent data in Head-to-Head matrix <code>get_h2h</code> has two more arguments (for detailed information see <code>?get_h2h</code>):</p>
<ul>
<li><code>absent_players</code>. It is a function that should do something with data of players that have not enough games played. To do nothing use <code>skip_action</code> function;</li>
<li><code>absent_h2h</code>. It is a function that should do something with those entries of Head-to-Head matrix which are <code>NA</code>. To do nothing use <code>skip_action</code> function.</li>
</ul>
<p>Examples of usage with extra players:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">get_h2h</span>(
  ncaa2005,
  <span class="dt">h2h_fun =</span> h2h_num,
  <span class="dt">players =</span> <span class="kw">c</span>(<span class="st">&quot;Duke&quot;</span>, <span class="st">&quot;Miami&quot;</span>, <span class="st">&quot;Extra&quot;</span>),
  <span class="dt">absent_players =</span> skip_action
)</code></pre></div>
<pre><code>##       Duke Miami Extra
## Duke     4     1    NA
## Miami    1     4    NA
## Extra   NA    NA    NA</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Use extra argument 'fill' to supply value for 'fill_h2h'</span>
<span class="kw">get_h2h</span>(
  ncaa2005,
  <span class="dt">h2h_fun =</span> h2h_num,
  <span class="dt">players =</span> <span class="kw">c</span>(<span class="st">&quot;Duke&quot;</span>, <span class="st">&quot;Miami&quot;</span>, <span class="st">&quot;Extra&quot;</span>),
  <span class="dt">absent_players =</span> skip_action,
  <span class="dt">absent_h2h =</span> fill_h2h, <span class="dt">fill =</span> <span class="dv">0</span>
)</code></pre></div>
<pre><code>##       Duke Miami Extra
## Duke     4     1     0
## Miami    1     4     0
## Extra    0     0     0</code></pre>
</div>
<div id="compute-item-summary" class="section level3">
<h3>Compute item summary</h3>
<p>With given CR it can be interesting to compute its summaries. Of course it can be done pretty easy with combination of <code>dplyr</code>s verbs and grouping but <code>comperes</code> provides a function for that: <code>get_item_summary(cr_data, item, summary_fun = NULL, ...)</code>. CR should be ready for <code>to_longcr</code> and every further actions are done based on <code>longcr</code> version of CR.</p>
<p>Argument <code>item</code> defines on which columns grouping is made for computing item summary. Argument <code>summary_fun</code> defines the function which performs summary computation. Basically <code>get_item_summary</code> applies <code>summary_fun</code> to groups of <code>longcr</code> version of CR data defined by <code>item</code>.</p>
<p><code>summary_fun</code> can be <code>NULL</code> in which case a tibble is returned with columns named as stored in <code>item</code> and which has all unique values of particular item (set of columns) in CR.</p>
<p>Examples:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">get_item_summary</span>(ncaa2005, <span class="dt">item =</span> <span class="st">&quot;player&quot;</span>,
                 <span class="dt">summary_fun =</span> summary_min_max_score)</code></pre></div>
<pre><code>## # A tibble: 5 x 3
##   player minScore maxScore
##    &lt;chr&gt;    &lt;int&gt;    &lt;int&gt;
## 1   Duke        0       21
## 2  Miami       25       52
## 3    UNC        3       24
## 4    UVA        5       38
## 5     VT        7       52</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">get_item_summary</span>(ncaa2005, <span class="dt">item =</span> <span class="st">&quot;game&quot;</span>,
                 <span class="dt">summary_fun =</span> <span class="ot">NULL</span>)</code></pre></div>
<pre><code>## # A tibble: 10 x 1
##     game
##    &lt;int&gt;
##  1     1
##  2     2
##  3     3
##  4     4
##  5     5
##  6     6
##  7     7
##  8     8
##  9     9
## 10    10</code></pre>
<p>For the list of implemented <code>summary_fun</code>s see help page for <code>item-summary-functions</code>.</p>
<p>There are also wrappers around <code>get_item_summary</code> for most common items:</p>
<ul>
<li><code>get_game_summary</code> for <code>item = &quot;game&quot;</code>;</li>
<li><code>get_player_summary</code> for <code>item = &quot;player&quot;</code>;</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The same as previous code</span>
<span class="kw">get_player_summary</span>(ncaa2005, <span class="dt">summary_fun =</span> summary_min_max_score)
<span class="kw">get_game_summary</span>(ncaa2005, <span class="dt">summary_fun =</span> <span class="ot">NULL</span>)</code></pre></div>
<p>Of course <code>item</code> can define multiple columns:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ncaa2005 %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">season =</span> <span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dt">each =</span> <span class="dv">10</span>)) %&gt;%
<span class="st">  </span><span class="kw">get_item_summary</span>(<span class="dt">item =</span> <span class="kw">c</span>(<span class="st">&quot;season&quot;</span>, <span class="st">&quot;player&quot;</span>),
                   <span class="dt">summary_fun =</span> summary_min_max_score)</code></pre></div>
<pre><code>## # A tibble: 9 x 4
##   season player minScore maxScore
##    &lt;int&gt;  &lt;chr&gt;    &lt;int&gt;    &lt;int&gt;
## 1      1   Duke        0       21
## 2      1  Miami       34       52
## 3      1    UNC       16       24
## 4      1    UVA       38       38
## 5      1     VT       45       45
## 6      2  Miami       25       27
## 7      2    UNC        3        7
## 8      2    UVA        5       17
## 9      2     VT        7       52</code></pre>
</div>
<div id="add-item-summary" class="section level3">
<h3>Add item summary</h3>
<p>In order to modify scores in CR so that they fully characterize player’s performance in particular game one might need to use item summaries. Instead of manually computing with <code>get_item_summary</code> and applying <code>left_join</code> to result, <code>comperes</code> provides <code>add_item_summary</code>. For example suppose the goal of players in <code>ncaa2005</code> was not to gain points more than opponent but to gain as close scores to opponent as possible. In this case <code>score</code> doesn’t fully describe the player’s performance. Instead the distance from the mean score can describe it:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ncaa2005 %&gt;%
<span class="st">  </span><span class="kw">add_item_summary</span>(<span class="dt">item =</span> <span class="st">&quot;game&quot;</span>,
                   <span class="dt">summary_fun =</span> summary_mean_sd_score) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">score =</span> <span class="kw">abs</span>(score -<span class="st"> </span>meanScore)) %&gt;%
<span class="st">  </span><span class="kw">print</span>(<span class="dt">n =</span> <span class="dv">6</span>)</code></pre></div>
<pre><code>## # A tibble: 20 x 5
##    game player score meanScore  sdScore
##   &lt;int&gt;  &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1     1   Duke  22.5      29.5 31.81981
## 2     1  Miami  22.5      29.5 31.81981
## 3     2   Duke   1.5      22.5  2.12132
## 4     2    UNC   1.5      22.5  2.12132
## 5     3   Duke  15.5      22.5 21.92031
## 6     3    UVA  15.5      22.5 21.92031
## # ... with 14 more rows</code></pre>
<p>Use of <code>add_item_summary</code> can be redundant in this example but in case of complex CR with variable number of players it can be quite useful.</p>
<p>There are also wrappers for the most common items: <code>add_game_summary</code> and <code>add_player_summary</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The same as previous example</span>
ncaa2005 %&gt;%
<span class="st">  </span><span class="kw">add_game_summary</span>(<span class="dt">summary_fun =</span> summary_mean_sd_score) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">score =</span> <span class="kw">abs</span>(score -<span class="st"> </span>meanScore)) %&gt;%
<span class="st">  </span><span class="kw">print</span>(<span class="dt">n =</span> <span class="dv">6</span>)</code></pre></div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
